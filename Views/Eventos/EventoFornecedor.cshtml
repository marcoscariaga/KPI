@{
    ViewData["Title"] = "Relatório de Eventos - Fornecedor";
}
@model List<KPI.Models.DashboardEventoModel>
@section Scripts{
    <script>
        var table = new DataTable('#dataTable', {
            language: {
                url: '//cdn.datatables.net/plug-ins/1.13.6/i18n/pt-BR.json',
            },
            dom: '<"top"Bf>rt<"bottom"lip><"clear">',
            buttons: [{
                extend: 'excelHtml5',
                text: 'Salvar no Excel',
                title: '',              
                autoFilter: true,
                sheetName: 'Fornecedor - Exportado KPI'
            }]
        });
    </script>
}
<div class="card">
    <h4>Relatório de Eventos - Fornecedor</h4><h6>Em @DateTime.Now</h6>
    <hr />
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-sm table-hover" id="dataTable" width="100%" cellspacing="0">
                <thead>
                    <tr>
                        <th>CPE</th>
                        <th>Data Solicitação</th>
                        <th>Processo</th>
                        <th>Data Evento</th>
                        <th>Data Fim Evento</th>
                        <th>Status</th>
                        <th>Nome Evento</th>
                        <th>Empresa Solicitante</th>
                        <th>Área</th>
                        <th>Data Pagamento</th>
                        <th>Valor Pagamento</th>
                        <th>Atividades Exercidas</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model)
                    {
                        <tr>
                            <td>@item.CPE</td>
                            <td>@item.DataDaSolicitacao.ToShortDateString()</td>
                            <td>@item.Processo</td>
                            <td>@item.DataInicioEvento.ToShortDateString()</td>
                            <td>@item.DataFimEvento.ToShortDateString()</td>
                            <td>@item.Status</td>
                            <td>@item.NomeDoEvento</td>
                            <td>@item.RazaoSocial</td>
                            <td>@item.Area</td>
                            <td>@item.DataPagamento.ToShortDateString()</td>
                            <td>@item.ValorPagamento.ToString("C")</td>
                            <td>@item.AtividadesExercidas</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>
<div class="loader"></div>